title="Top Five Cities for Coal Expenditures in 2012",
x="State",
y="Coal Expenditures"
)+
theme(legend.position = 'none')+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
coalE2012
#Top 5 city in coal2013
coalE2013<-coal%>%
filter(Year==2013)%>%
arrange(desc(CoalExpenditures))%>%
slice(1:5)%>%
ggplot(aes(x=reorder(State,CoalExpenditures),y=CoalExpenditures))+geom_col(aes(fill=State))+
labs(
title="Top Five Cities for Coal Expenditures in 2013",
x="State",
y="Coal Expenditures"
)+
theme(legend.position = 'none')+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
coalE2013
#Top 5 city in coal2014
coalE2014<-coal%>%
filter(Year==2014)%>%
arrange(desc(CoalExpenditures))%>%
slice(1:5)%>%
ggplot(aes(x=reorder(State,CoalExpenditures),y=CoalExpenditures))+geom_col(aes(fill=State))+
labs(
title="Top Five Cities for Coal Expenditures in 2014",
x="State",
y="Coal Expenditures"
)+
theme(legend.position = 'none')+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
coalE2014
#Combine all together
ggarrange(coalEgeneral,coalE2010,coalE2011,coalE2012,coalE2013,coalE2014,nrow=2,ncol=3)
#Boxplot to show mean, median, min, max for each energy by coasts annually
coal$Year=as.character(coal$Year)
# is_outlier that will return a boolean TRUE/FALSE if the value passed to it is an outlier.
is_outlier <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5* IQR(x))
}
#General
coalEboxgeneral<-coal%>%
mutate(outlier = ifelse(is_outlier(CoalExpenditures),State, as.numeric(NA))) %>%
ggplot(aes(x=Year,y=CoalExpenditures,fill=Year))+geom_boxplot(outlier.colour="red", outlier.shape=8, outlier.size=4) +
geom_jitter()+
labs(
title="Boxplot for Coal Expenditures from 2010 to 2014",
x="Year",
y="Expenditures",
)+
geom_text(aes(label = outlier,color=outlier), na.rm = TRUE, hjust = 0.1)+
theme(plot.title = element_text(hjust = 0.5))
coalEboxgeneral
#2010
coalEbox2010<-coal%>%
filter(Year==2010)%>%
ggplot(aes(x=factor(Region),y=CoalExpenditures,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Expenditures in 2010 Based on Region",
x="Region",
y="Expenditures",
)+
theme(plot.title = element_text(hjust = 0.5))
coalEbox2010
#2011
coalEbox2011<-coal%>%
filter(Year==2011)%>%
ggplot(aes(x=factor(Region),y=CoalExpenditures,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Expenditures in 2011 Based on Region",
x="Region",
y="Expenditures",
)+
theme(plot.title = element_text(hjust = 0.5))
coalEbox2011
#2012
coalEbox2012<-coal%>%
filter(Year==2012)%>%
ggplot(aes(x=factor(Region),y=CoalExpenditures,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Expenditures in 2012 Based on Region",
x="Region",
y="Expenditures",
)+
theme(plot.title = element_text(hjust = 0.5))
coalEbox2012
#2013
coalEbox2013<-coal%>%
filter(Year==2013)%>%
ggplot(aes(x=factor(Region),y=CoalExpenditures,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Expenditures in 2013 Based on Region",
x="Region",
y="Expenditures",
)+
theme(plot.title = element_text(hjust = 0.5))
coalEbox2013
#2014
coalEbox2014<-coal%>%
filter(Year==2014)%>%
ggplot(aes(x=factor(Region),y=CoalExpenditures,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Expenditures in 2014 Based on Region",
x="Region",
y="Expenditures",
)+
theme(plot.title = element_text(hjust = 0.5))
coalEbox2014
#Combine all together
ggarrange(coalEboxgeneral,coalEbox2010,coalEbox2011,coalEbox2012,coalEbox2013,coalEbox2014,nrow=2,ncol=3)
#Time series for Coal Expenditures
coal$Year=as.numeric(coal$Year)
ggplot(coal,aes(x = Year,y = CumCoalExpenditures)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Boxplot to show mean, median, min, max for each energy by coasts annually
coal$Year=as.character(coal$Year)
# is_outlier that will return a boolean TRUE/FALSE if the value passed to it is an outlier.
is_outlier <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5* IQR(x))
}
#General
coalPriceboxgeneral<-coal%>%
mutate(outlier = ifelse(is_outlier(CoalPrice),State, as.numeric(NA))) %>%
ggplot(aes(x=Year,y=CoalPrice,fill=Year))+geom_boxplot(outlier.colour="red", outlier.shape=8, outlier.size=4) +
geom_jitter()+
labs(
title="Boxplot for Coal Expenditures from 2010 to 2014",
x="Year",
y="Price",
)+
geom_text(aes(label = outlier,color=outlier), na.rm = TRUE, hjust = 0.1)+
theme(plot.title = element_text(hjust = 0.5))
coalPriceboxgeneral
#2010
coalPricebox2010<-coal%>%
filter(Year==2010)%>%
ggplot(aes(x=factor(Region),y=CoalPrice,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Price in 2010 Based on Region",
x="Region",
y="Price",
)+
theme(plot.title = element_text(hjust = 0.5))
coalPricebox2010
#2011
coalPricebox2011<-coal%>%
filter(Year==2011)%>%
ggplot(aes(x=factor(Region),y=CoalPrice,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Price in 2011 Based on Region",
x="Region",
y="Price",
)+
theme(plot.title = element_text(hjust = 0.5))
coalPricebox2011
#2012
coalPricebox2012<-coal%>%
filter(Year==2012)%>%
ggplot(aes(x=factor(Region),y=CoalPrice,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Price in 2012 Based on Region",
x="Region",
y="Price",
)+
theme(plot.title = element_text(hjust = 0.5))
coalPricebox2012
#2013
coalPricebox2013<-coal%>%
filter(Year==2013)%>%
ggplot(aes(x=factor(Region),y=CoalPrice,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Price in 2013 Based on Region",
x="Region",
y="Price",
)+
theme(plot.title = element_text(hjust = 0.5))
coalPricebox2013
#2014
coalPricebox2014<-coal%>%
filter(Year==2014)%>%
ggplot(aes(x=factor(Region),y=CoalPrice,fill=factor(Region)))+geom_violin()+
labs(
title="Violin Boxplot for Coal Price in 2014 Based on Region",
x="Region",
y="Price",
)+
theme(plot.title = element_text(hjust = 0.5))
coalPricebox2014
#Combine all together
ggarrange(coalPriceboxgeneral,coalPricebox2010,coalPricebox2011,coalPricebox2012,coalPricebox2013,coalPricebox2014,nrow=2,ncol=3)
#Time series for Coal Price
coal$Year=as.numeric(coal$Year)
ggplot(coal,aes(x = Year,y = CumCoalPrice)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Boxplot to show mean, median, min, max for each energy by coasts annually
# is_outlier that will return a boolean TRUE/FALSE if the value passed to it is an outlier.
is_outlier <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5* IQR(x))
}
#General
ElecCboxgeneral<-ggplot(Elec,aes(x=Year,y=ElecConsumption,fill=Year))+geom_boxplot(outlier.colour="red", outlier.shape=8, outlier.size=4) +
geom_jitter()+
geom_text(aes(label = outlier,color=outlier), na.rm = TRUE, hjust = -0.5)+labs(
title="Boxplot for Biomass Conumption from 2010 to 2014",
x="Year",
y="ElecConsumption",
)
ElecCboxgeneral
library(tidyverse)
library(ggplot2)
library(ggpubr)
data <- read_csv("Energy Census and Economic Data US 2010-2014.csv")
head(data)
str(data)
#remove NA
data=na.omit(data)
#Filter data for ElecC
ElecC<-data%>%
select("StateCodes","State","Region","Division","Coast",`Great Lakes`,"ElecC2010","ElecC2011","ElecC2012","ElecC2013","ElecC2014")%>%
pivot_longer(c("ElecC2010","ElecC2011","ElecC2012","ElecC2013","ElecC2014"), names_to = "Year", values_to = "ElecConsumption")
#Clean Year ElecC
ElecC$Year<-gsub("ElecC","",as.character(ElecC$Year))
#Display the outcome
ElecC
#Filter data for ElecE
ElecE<-data%>%
select("StateCodes","ElecE2010","ElecE2011","ElecE2012","ElecE2013","ElecE2014")%>%
pivot_longer(c("ElecE2010","ElecE2011","ElecE2012","ElecE2013","ElecE2014"), names_to = "Year", values_to = "ElecExpenditures")
#Clean Year ElecE
ElecE$Year<-gsub("ElecE","",as.character(ElecE$Year))
#Display the outcome
ElecE
#Filter data for ElecPrice
ElecPrice<-data%>%
select("StateCodes","ElecPrice2010","ElecPrice2011","ElecPrice2012","ElecPrice2013","ElecPrice2014")%>%
pivot_longer(c("ElecPrice2010","ElecPrice2011","ElecPrice2012","ElecPrice2013","ElecPrice2014"), names_to = "Year", values_to = "ElecPrice")
#Clean Year ElecPrice
ElecPrice$Year<-gsub("ElecPrice","",as.character(ElecPrice$Year))
#Display the outcome
ElecPrice
#Join four Tables into one
Elec<-left_join(ElecC,ElecE,by=c('StateCodes','Year'))
Elec<-left_join(Elec,ElecPrice,by=c('StateCodes','Year'))
Elec<-Elec%>%
mutate(CumElecConsumption=cumsum(ElecConsumption))%>%
mutate(CumElecExpenditures=cumsum(ElecExpenditures))%>%
mutate(CumElecPrice=cumsum(ElecPrice))
Elec
#Rank top 5 state of Elec Elec each year. (Bar plot)
#Overall
ElecCgeneral<-ggplot(data=Elec,aes(y=ElecConsumption,x=reorder(State,ElecConsumption)))+geom_col(aes(fill=State))+
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))+
labs(
x="State",
y="ElecConsumption"
)+
theme(legend.position = 'none')
ElecCgeneral+facet_grid(Year ~.)
#Top 5 city in ElecC2010
ElecC2010<-Elec%>%
filter(Year==2010)%>%
arrange(desc(ElecConsumption))%>%
slice(1:5)%>%
ggplot(aes(x=reorder(State,ElecConsumption),y=ElecConsumption))+geom_col(aes(fill=State))+
labs(
x="State",
y="ElecConsumption"
)+
theme(legend.position = 'none')+
coord_flip()
ElecC2010
#Top 5 city in ElecC2011
ElecC2011<-Elec%>%
filter(Year==2011)%>%
arrange(desc(ElecConsumption))%>%
slice(1:5)%>%
ggplot(aes(x=reorder(State,ElecConsumption),y=ElecConsumption))+geom_col(aes(fill=State))+
labs(
x="State",
y="ElecConsumption"
)+
theme(legend.position = 'none')+
coord_flip()
ElecC2011
#Top 5 city in ElecC2012
ElecC2012<-Elec%>%
filter(Year==2012)%>%
arrange(desc(ElecConsumption))%>%
slice(1:5)%>%
ggplot(aes(x=reorder(State,ElecConsumption),y=ElecConsumption))+geom_col(aes(fill=State))+
labs(
x="State",
y="ElecConsumption"
)+
theme(legend.position = 'none')+
coord_flip()
ElecC2012
#Top 5 city in ElecC2013
ElecC2013<-Elec%>%
filter(Year==2013)%>%
arrange(desc(ElecConsumption))%>%
slice(1:5)%>%
ggplot(aes(x=reorder(State,ElecConsumption),y=ElecConsumption))+geom_col(aes(fill=State))+
labs(
x="State",
y="ElecConsumption"
)+
theme(legend.position = 'none')+
coord_flip()
ElecC2013
#Top 5 city in ElecC2014
ElecC2014<-Elec%>%
filter(Year==2014)%>%
arrange(desc(ElecConsumption))%>%
slice(1:5)%>%
ggplot(aes(x=reorder(State,ElecConsumption),y=ElecConsumption))+geom_col(aes(fill=State))+
labs(
x="State",
y="ElecConsumption"
)+
theme(legend.position = 'none')+
coord_flip()
ElecC2014
#Combine all together
ggarrange(ElecC2010,ElecC2010,ElecC2011,ElecC2012,ElecC2013,ElecC2014,nrow=2,ncol=3)
#Boxplot to show mean, median, min, max for each energy by coasts annually
# is_outlier that will return a boolean TRUE/FALSE if the value passed to it is an outlier.
is_outlier <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5* IQR(x))
}
#General
ElecCboxgeneral<-ggplot(Elec,aes(x=Year,y=ElecConsumption,fill=Year))+geom_boxplot(outlier.colour="red", outlier.shape=8, outlier.size=4) +
geom_jitter()+
geom_text(aes(label = outlier,color=outlier), na.rm = TRUE, hjust = -0.5)+labs(
title="Boxplot for Biomass Conumption from 2010 to 2014",
x="Year",
y="ElecConsumption",
)
ElecCboxgeneral
#Boxplot to show mean, median, min, max for each energy by coasts annually
# is_outlier that will return a boolean TRUE/FALSE if the value passed to it is an outlier.
is_outlier <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5* IQR(x))
}
#General
ElecCboxgeneral<-Elec%>%
mutate(outlier = ifelse(is_outlier(ElecConsumption),State, as.numeric(NA))) %>%
ggplot(aes(x=Year,y=ElecConsumption,fill=Year))+geom_boxplot(outlier.colour="red", outlier.shape=8, outlier.size=4) +
geom_jitter()+
geom_text(aes(label = outlier,color=outlier), na.rm = TRUE, hjust = -0.5)+labs(
title="Boxplot for Biomass Conumption from 2010 to 2014",
x="Year",
y="ElecConsumption",
)
ElecCboxgeneral
#2010
ElecCbox2010<-Elec%>%
filter(Year==2010)%>%
ggplot(aes(x=factor(Region),y=ElecConsumption,fill=factor(Region)))+geom_violin()
ElecCbox2010
#2011
ElecCbox2011<-Elec%>%
filter(Year==2011)%>%
ggplot(aes(x=factor(Region),y=ElecConsumption,fill=factor(Region)))+geom_violin()
ElecCbox2011
#2012
ElecCbox2012<-Elec%>%
filter(Year==2012)%>%
ggplot(aes(x=factor(Region),y=ElecConsumption,fill=factor(Region)))+geom_violin()
ElecCbox2012
#2013
ElecCbox2013<-Elec%>%
filter(Year==2013)%>%
ggplot(aes(x=factor(Region),y=ElecConsumption,fill=factor(Region)))+geom_violin()
ElecCbox2013
#2014
ElecCbox2014<-Elec%>%
filter(Year==2014)%>%
ggplot(aes(x=factor(Region),y=ElecConsumption,fill=factor(Region)))+geom_violin()
ElecCbox2014
#Combine all together
ggarrange(ElecCboxgeneral,ElecCbox2010,ElecCbox2011,ElecCbox2012,ElecCbox2013,ElecCbox2014,nrow=2,ncol=3)
#Time series for Elec Consumption
Elec$Year=as.numeric(Elec$Year)
Elec%>%
filter(StateCodes=="CA"|StateCodes=="FL"|State=="Texas")%>%
ggplot(aes(x = Year,y = CumElecConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Time series for Elec Expenditures
Elec$Year=as.numeric(Elec$Year)
Elec%>%
filter(StateCodes=="CA"|StateCodes=="FL"|State=="Texas"|StateCodes=="NY"|Statecodes=="PA")%>%
ggplot(aes(x = Year,y = CumElecConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Time series for Elec Consumption
Elec$Year=as.numeric(Elec$Year)
Elec%>%
filter(StateCodes=="CA"|StateCodes=="FL"|State=="Texas")%>%
ggplot(aes(x = Year,y = CumElecConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Time series for Elec Expenditures
Elec$Year=as.numeric(Elec$Year)
Elec%>%
filter(StateCodes=="CA"|StateCodes=="FL"|State=="Texas"|StateCodes=="NY"|Statecodes=="PA")%>%
ggplot(aes(x = Year,y = CumElecConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Time series for Elec Expenditures
Elec$Year=as.numeric(Elec$Year)
Elec%>%
filter(StateCodes=="CA"|StateCodes=="FL"|State=="Texas")%>%
ggplot(aes(x = Year,y = CumElecConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Time series for Elec Expenditures
Elec$Year=as.numeric(Elec$Year)
Elec%>%
filter(StateCodes=="CA"|StateCodes=="FL"|State=="Texas"|StateCodes=="NY"|StateCodes=="PA")%>%
ggplot(aes(x = Year,y = CumElecConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Boxplot to show mean, median, min, max for each energy by coasts annually
Elec$Year=as.character(Elec$Year)
# is_outlier that will return a boolean TRUE/FALSE if the value passed to it is an outlier.
is_outlier <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5* IQR(x))
}
#General
ElecCboxgeneral<-Elec%>%
mutate(outlier = ifelse(is_outlier(ElecPrice),State, as.numeric(NA))) %>%
ggplot(aes(x=Year,y=ElecPrice,fill=Year))+geom_boxplot(outlier.colour="red", outlier.shape=8, outlier.size=4) +
geom_jitter()+
geom_text(aes(label = outlier,color=outlier), na.rm = TRUE, hjust = -0.5)+labs(
title="Boxplot for Biomass Conumption from 2010 to 2014",
x="Year",
y="ElecPrice",
)
ElecPriceboxgeneral
#2010
ElecPricebox2010<-Elec%>%
filter(Year==2010)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2010
#2011
ElecPricebox2011<-Elec%>%
filter(Year==2011)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2011
#2012
ElecPricebox2012<-Elec%>%
filter(Year==2012)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2012
#2013
ElecPricebox2013<-Elec%>%
filter(Year==2013)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2013
#2014
ElecPricebox2014<-Elec%>%
filter(Year==2014)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2014
#Combine all together
ggarrange(ElecPriceboxgeneral,ElecPricebox2010,ElecPricebox2011,ElecPricebox2012,ElecPricebox2013,ElecPricebox2014,nrow=2,ncol=3)
#Boxplot to show mean, median, min, max for each energy by coasts annually
Elec$Year=as.character(Elec$Year)
# is_outlier that will return a boolean TRUE/FALSE if the value passed to it is an outlier.
is_outlier <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5* IQR(x))
}
#General
ElecPriceboxgeneral<-Elec%>%
mutate(outlier = ifelse(is_outlier(ElecPrice),State, as.numeric(NA))) %>%
ggplot(aes(x=Year,y=ElecPrice,fill=Year))+geom_boxplot(outlier.colour="red", outlier.shape=8, outlier.size=4) +
geom_jitter()+
geom_text(aes(label = outlier,color=outlier), na.rm = TRUE, hjust = -0.5)+labs(
title="Boxplot for Biomass Conumption from 2010 to 2014",
x="Year",
y="ElecPrice",
)
ElecPriceboxgeneral
#2010
ElecPricebox2010<-Elec%>%
filter(Year==2010)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2010
#2011
ElecPricebox2011<-Elec%>%
filter(Year==2011)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2011
#2012
ElecPricebox2012<-Elec%>%
filter(Year==2012)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2012
#2013
ElecPricebox2013<-Elec%>%
filter(Year==2013)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2013
#2014
ElecPricebox2014<-Elec%>%
filter(Year==2014)%>%
ggplot(aes(x=factor(Region),y=ElecPrice,fill=factor(Region)))+geom_violin()
ElecPricebox2014
#Combine all together
ggarrange(ElecPriceboxgeneral,ElecPricebox2010,ElecPricebox2011,ElecPricebox2012,ElecPricebox2013,ElecPricebox2014,nrow=2,ncol=3)
#Time series for Elec Consumption
Elec$Year=as.numeric(Elec$Year)
Elec%>%
filter(StateCodes=="AK"|StateCodes=="CT"|State=="Hawaii")%>%
ggplot(aes(x = Year,y = CumElecConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
#Time series for Biomass Consumption
Biomass$Year=as.numeric(Biomass$Year)
ggplot(Biomass,aes(x = Year,y = CumBiomassConsumption)) +geom_point(aes(color=factor(State))) +geom_line(aes(color=factor(State)))
